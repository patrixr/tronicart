<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.0">
<title>Three Body Problem | Tronicart</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-parchment.d89d0dee.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-parchment.d89d0dee.css">
<link rel="modulepreload" href="./_observablehq/client.b6605194.js">
<link rel="modulepreload" href="./_observablehq/runtime.9393ab6d.js">
<link rel="modulepreload" href="./_observablehq/stdlib.95bfbf7e.js">
<link rel="modulepreload" href="./_import/components/sketch.16785f60.js">
<link rel="modulepreload" href="./_import/lib/palette.60ed8170.js">
<link rel="modulepreload" href="./_import/lib/celestial-body.fde4f9ee.js">
<link rel="modulepreload" href="./_import/lib/helpers.23012005.js">
<link rel="modulepreload" href="./_import/lib/dom.46cf68a8.js">
<link rel="modulepreload" href="./_node/p5@1.11.2/index.1b9ecc21.js">
<link rel="modulepreload" href="./_node/color-scheme@1.0.1/index.18fc79b9.js">
<link rel="modulepreload" href="./_import/lib/math.e381bcd0.js">
<script type="module">

import {define} from "./_observablehq/client.b6605194.js";

define({id: "4a5235c0", outputs: ["sketch","Palette","CelestialBody","h","w"], body: async () => {
const [{sketch}, {Palette}, {CelestialBody}] = await Promise.all([import("./_import/components/sketch.16785f60.js"), import("./_import/lib/palette.60ed8170.js"), import("./_import/lib/celestial-body.fde4f9ee.js")]);

CelestialBody.MAX_TRAIL_LEN = 400

const h = 1080 / 3
const w = 1920 / 3
return {sketch,Palette,CelestialBody,h,w};
}});

define({id: "03143039", inputs: ["sketch","Palette","w","h","CelestialBody","display"], body: async (sketch,Palette,w,h,CelestialBody,display) => {
display(await(
sketch((p5) => {
  const palette = new Palette({ p5 })

  const bodies = []
  const numBodies = 3
  const radius = 0.15 * w
  const angleIncrement = (2 * Math.PI) / numBodies
  const startAngle = 0 //Math.PI
  for (let i = 0; i < numBodies; i++) {
    const x = w / 2 + radius * Math.cos(startAngle + i * angleIncrement)
    const y = h / 2 + radius * Math.sin(startAngle + i * angleIncrement)
    bodies.push(new CelestialBody({ p5, x, y, mass: 100 }))
  }

  p5.setup = () => {
    p5.createCanvas(w, h)
    p5.frameRate(60)
    p5.noStroke()
    p5.fill(255)
  }

  p5.draw = () => {
    p5.push()
    p5.background(0)

    // Base rotation
    p5.translate(w / 2, h / 2)
    p5.rotate(p5.PI / 2)
    p5.translate(-w / 2, -h / 2)

    const centerOfGravity = CelestialBody.centerOfMass(bodies)
    p5.translate(w / 2 - centerOfGravity.x, h / 2 - centerOfGravity.y)
    bodies.forEach((body, idx) => {
      body.update(bodies)

      p5.noFill()
      p5.strokeWeight(5)

      if (body.trail.length < 2) return

      for (let i = 0; i < body.trail.length - 1; ++i) {
        const c = palette.lerped(60, body.trail[i].tick)
        const pt1 = body.trail[i].pos
        const pt2 = body.trail[i + 1].pos
        const alpha = p5.map(i, 0, body.trail.length, 0, 255)
        c.setAlpha(alpha)
        p5.stroke(c)
        p5.line(pt1.x, pt1.y, pt2.x, pt2.y)
      }

      // Draw halo around body
      p5.noStroke()
      p5.fill(255, 50)
      p5.circle(body.pos.x, body.pos.y, 30)
      p5.fill(255, 70)
      p5.circle(body.pos.x, body.pos.y, 20)
      p5.strokeWeight(1)
      p5.noFill()

      // Draw lines between bodies
      const nextBody = bodies[(idx + 1) % bodies.length]
      p5.stroke(255, 204, 100, 100)
      p5.line(body.pos.x, body.pos.y, nextBody.pos.x, nextBody.pos.y)
    })
    p5.pop()
  }
})
))
}});

</script>
</head>
<body>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Tronicart</a></li>
  </ol>
  <div id="observablehq-search"><input type="search" placeholder="Search"></div>
  <div id="observablehq-search-results"></div>
  <script>{const o=document.querySelector("#observablehq-search");o.setAttribute("data-shortcut",`${/Mac|iPhone/.test(navigator.platform)?"\u2318":"Alt-"}K`);const t=o.querySelector("input"),r=()=>import("./_observablehq/search.176e2af2.js");t.addEventListener("focus",r,{once:!0}),t.addEventListener("keydown",r,{once:!0});const c=document.querySelector("#observablehq-sidebar-toggle");addEventListener("keydown",e=>{(e.code==="KeyK"&&e.metaKey&&!e.altKey&&!e.ctrlKey||e.key==="/"&&!e.metaKey&&!e.altKey&&!e.ctrlKey&&e.target===document.body)&&(c.checked?t.focus():(c.click(),t.focus(),c.click()),t.select(),e.preventDefault())});}</script>
  <ol>
    <li class="observablehq-link"><a href="./byte-tiles">Bit operations for creative coding</a></li>
    <li class="observablehq-link"><a href="./composition">Composable Sketches</a></li>
    <li class="observablehq-link"><a href="./differential-growth-basics">Differential Growth Basics</a></li>
    <li class="observablehq-link"><a href="./falling-sand">Falling Sand</a></li>
    <li class="observablehq-link"><a href="./hand-drawn">Hand drawn lines</a></li>
    <li class="observablehq-link"><a href="./orbital-mechanics">Orbital Mechanics</a></li>
    <li class="observablehq-link"><a href="./raytracing-wasm">Raytracing using Go and WebAssembly</a></li>
    <li class="observablehq-link observablehq-link-active"><a href="./three-body-problem">Three Body Problem</a></li>
    <li class="observablehq-link"><a href="./triangles">Triangles</a></li>
  </ol>
</nav>
<script>{const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
<div>Contents</div>
<ol>
<li class="observablehq-secondary-link"><a href="#chaos-theory">Chaos theory</a></li>
<li class="observablehq-secondary-link"><a href="#setting-up-the-simulation">Setting up the simulation</a></li>
<li class="observablehq-secondary-link"><a href="#simulation">Simulation</a></li>
</ol>
</nav>
</aside>
<main id="observablehq-main" class="observablehq">
<h1 id="three-body-problem" tabindex="-1"><a class="observablehq-header-anchor" href="#three-body-problem">Three Body Problem</a></h1>
<p>This sketch simulates a three-body system in a two-dimensional space using p5.js. It is inspired by the <a href="https://en.wikipedia.org/wiki/The_Three-Body_Problem_(novel)" target="_blank" rel="noopener noreferrer">book</a> and <a href="https://en.wikipedia.org/wiki/3_Body_Problem_(TV_series)" target="_blank" rel="noopener noreferrer">TV Series</a> titled "3 Body Problem"</p>
<p>To go straight to the simulation, please <a href="#simulation">scroll to the simulation</a> below.</p>
<h2 id="chaos-theory" tabindex="-1"><a class="observablehq-header-anchor" href="#chaos-theory">Chaos theory</a></h2>
<p>The system consists of three celestial bodies that interact with each other through gravity, influencing their positions and movements over time. This is a classic example of a chaotic system, where small changes in initial conditions can lead to vastly different outcomes. The simulation demonstrates how the three-body system evolves dynamically, showcasing the complex and unpredictable nature of <strong>chaotic systems</strong>.</p>
<h2 id="setting-up-the-simulation" tabindex="-1"><a class="observablehq-header-anchor" href="#setting-up-the-simulation">Setting up the simulation</a></h2>
<p>The code is based on a <a href="./orbital-mechanics">previous implementation of orbital mechanics</a>. The main requirements for this simulation are:</p>
<ol>
<li><strong>The 3 celestial bodies should be of comparable mass</strong> <br>
This problem will not work if one or more bodies have a mass that is significantly different than the others. We can think of the earth, moon and sun, which is not a 3 body problem because the sun is so massive that it dominates the system.</li>
<li><strong>One body should not be too far away from the other two</strong> <br>
The bodies should be close enough to interact with each other. If one body is too far away, it might not be influenced by the other two, leading to a 2 body system instead</li>
</ol>
<div class="observablehq observablehq--block"><!--:4a5235c0:--></div>
<h2 id="simulation" tabindex="-1"><a class="observablehq-header-anchor" href="#simulation">Simulation</a></h2>
<div id="simulation">
<div class="warning" label="Warning️">
  Chaotic systems can easily get out of control and lead to unstable or unpredictable behavior. Should it look odd, please use the "Replay" button to restart the simulation.
</div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:03143039:--></div>
</div></main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./raytracing-wasm"><span>Raytracing using Go and WebAssembly</span></a><a rel="next" href="./triangles"><span>Triangles</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2024-12-30T08:15:30">Dec 30, 2024</a>.</div>
</footer>
</div>
</body>
</html>
